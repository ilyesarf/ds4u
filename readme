better implementation of the core of https://github.com/ilyesarf/pcshock
